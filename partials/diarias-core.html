<!--
DIARIAS-CORE ‚Äî PARTIAL
- herda SOMENTE layout do KM-core
- fluxo e sem√¢ntica seguem diarias.aspx
-->

<style>
  :root{
    --card-bg:#0b1220;
    --border-subtle:rgba(148,163,184,.25);
    --text-muted:#9ca3af;
  }

  #blaq-diarias{
    width:100%;
    display:flex;
    justify-content:center;
    padding:2.5rem 1rem;
  }

  .card{
    width:100%;
    max-width:1200px;
    background:
      radial-gradient(circle at top left, rgba(56,189,248,.12), transparent 55%),
      var(--card-bg);
    border-radius:1.5rem;
    border:1px solid var(--border-subtle);
    box-shadow:0 24px 60px rgba(15,23,42,.8);
    padding:1.75rem 1.75rem 2rem;
  }

  /* =========================
     BADGE DE MISS√ÉO (ASPX)
  ========================= */
  .badge-missao{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:4px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:500;
    border:1px solid rgba(148,163,184,.25);
    background:rgba(15,23,42,.6);
    color:#e5e7eb;
    white-space:nowrap;
  }

  .badge-missao .dot{
    width:6px;
    height:6px;
    border-radius:999px;
  }

  .badge-missao.partida{ border-color:rgba(56,189,248,.5); }
  .badge-missao.partida .dot{ background:#38bdf8; }

  .badge-missao.retorno{ border-color:rgba(34,197,94,.5); }
  .badge-missao.retorno .dot{ background:#22c55e; }

  .badge-missao.forabase{ border-color:rgba(249,115,22,.5); }
  .badge-missao.forabase .dot{ background:#f97316; }

  .badge-missao.base{ border-color:rgba(148,163,184,.5); }
  .badge-missao.base .dot{ background:#94a3b8; }

  .badge-missao.gap{ border-color:rgba(168,85,247,.5); }
  .badge-missao.gap .dot{ background:#a855f7; }

  /* =========================
     C / A / J / CE (p√≠lulas)
  ========================= */
  .pill{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:20px;
    height:20px;
    border-radius:999px;
    font-size:11px;
    border:1px solid rgba(148,163,184,.25);
    color:#94a3b8;
  }

  .pill.on{
    background:rgba(34,197,94,.15);
    border-color:rgba(34,197,94,.5);
    color:#22c55e;
    font-weight:600;
  }

  /* =========================
     TABELA ‚Äî DENSIDADE ASPX
  ========================= */
  .tbl-diarias th,
  .tbl-diarias td{
    padding:6px 8px;
    vertical-align:middle;
  }

  .tbl-diarias thead th{
    font-size:0.65rem;
    letter-spacing:.08em;
  }

  .tbl-diarias tbody tr:hover{
    background:rgba(15,23,42,.6);
  }
</style>

<div id="blaq-diarias">
  <div class="card">

    <!-- HEADER -->
    <header class="flex items-center justify-between mb-8 pb-4 border-b border-slate-700/50">
      <div>
        <h1 class="text-xl sm:text-2xl font-semibold text-slate-100 tracking-tight">
          C√°lculo de Di√°rias
        </h1>
        <span class="text-xs text-slate-400">
          M√≥dulo ‚Äî regras operacionais por miss√£o e tripulante
        </span>
      </div>

      <div class="flex items-center gap-2">

  <button id="btnProcessar"
          class="inline-flex items-center gap-2 px-4 py-2 rounded-xl
                 bg-sky-600/90 hover:bg-sky-500 text-white text-sm
                 disabled:opacity-40 disabled:cursor-not-allowed"
          disabled>
    Processar di√°rias
  </button>

  <button id="btnPrintDiarias" type="button"
          class="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-xl
                 border border-slate-300/40 text-slate-200 hover:bg-slate-700/40 transition text-sm
                 disabled:opacity-40 disabled:cursor-not-allowed"
          disabled>
    üñ®Ô∏è Imprimir
  </button>

   <button id="btnAddLinhaManual"
          class="ml-2 px-3 py-1 rounded-lg
                 border border-slate-600
                 text-xs text-slate-200
                 hover:bg-slate-800">
    ‚ûï Linha manual
  </button>


</div>

    </header>

    <!-- IMPORTA√á√ÉO -->
    <div class="border border-slate-700/60 rounded-2xl bg-slate-900/60 p-4 mb-4">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">

        <div>
          <label class="block text-xs font-medium text-slate-300 mb-1">
            1. Selecione a planilha de controle (.xlsm)
          </label>
          <input id="fileInput" type="file"
                 accept=".xlsx,.xlsm,.xls"
                 class="block w-full text-xs text-slate-200
                        file:mr-3 file:py-1.5 file:px-3 file:rounded-full
                        file:bg-sky-600 file:text-white
                        hover:file:bg-sky-500
                        bg-slate-900/80 border border-slate-700/70 rounded-xl px-2 py-1"/>
          <p class="text-[0.7rem] text-slate-500 mt-1">
            Mesmo arquivo utilizado no diarias.aspx (abas mensais).
          </p>
        </div>

        <div>
          <label class="block text-xs font-medium text-slate-300 mb-1">
            2. Selecione o m√™s (aba)
          </label>
          <div id="sheetPicker" class="flex flex-wrap gap-1.5"></div>
          <div id="sheetInfo" class="text-[0.7rem] text-slate-500 mt-1"></div>
        </div>

      </div>
    </div>

    <!-- STATUS -->
    <div id="statusBox" class="text-xs text-slate-400 mb-4">
      Selecione a planilha para iniciar.
    </div>

    <!-- RESUMO -->
    <div id="resumoTotais"
         class="hidden mb-3 text-xs text-slate-300
                border border-slate-700/60 rounded-2xl
                bg-slate-900/60 p-3">
    </div>

    <!-- RESULTADO -->
    <div class="border border-slate-700/60 rounded-2xl bg-slate-950/70 overflow-hidden">

      <div class="px-3 py-2 border-b border-slate-800/80
            flex items-center justify-between gap-2
            text-[0.75rem] text-slate-400">

  <span>Resultado por miss√£o (voo) / tripulante (hor√°rio local)</span>

  <div class="flex items-center gap-2">
    <span class="text-[0.7rem]">Matr√≠cula:</span>
    <select id="filtroMatricula"
            class="bg-slate-900 border border-slate-700 rounded-lg
                   px-2 py-1 text-xs text-slate-200">
      <option value="TODAS">Todas</option>
    </select>
  </div>

</div>


      <div class="max-h-[480px] overflow-auto">
        <table class="min-w-full text-left text-xs text-slate-200 tbl-diarias">

          <thead id="theadDiarias"
                 class="border-b border-slate-800 text-[0.7rem] uppercase tracking-wide text-slate-400">
          </thead>

          <tbody id="tbodyResultado" class="divide-y divide-slate-800/80">
            <tr>
              <td colspan="20" class="px-3 py-6 text-center text-xs text-slate-400">
                Aguardando arquivo e sele√ß√£o de m√™s‚Ä¶
              </td>
            </tr>
          </tbody>

        </table>
      </div>
    </div>

  </div>
</div>
